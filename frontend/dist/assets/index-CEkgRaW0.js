(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();var ie,h,Xe,F,Ie,Ye,we,K={},Ze=[],$t=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ce=Array.isArray;function M(e,t){for(var n in t)e[n]=t[n];return e}function Qe(e){var t=e.parentNode;t&&t.removeChild(e)}function St(e,t,n){var a,o,r,d={};for(r in t)r=="key"?a=t[r]:r=="ref"?o=t[r]:d[r]=t[r];if(arguments.length>2&&(d.children=arguments.length>3?ie.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)d[r]===void 0&&(d[r]=e.defaultProps[r]);return ne(e,d,a,o,null)}function ne(e,t,n,a,o){var r={type:e,props:t,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:o??++Xe,__i:-1,__u:0};return o==null&&h.vnode!=null&&h.vnode(r),r}function ce(e){return e.children}function oe(e,t){this.props=e,this.context=t}function W(e,t){if(t==null)return e.__?W(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?W(e):null}function et(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return et(e)}}function De(e){(!e.__d&&(e.__d=!0)&&F.push(e)&&!se.__r++||Ie!==h.debounceRendering)&&((Ie=h.debounceRendering)||Ye)(se)}function se(){var e,t,n,a,o,r,d,_,f;for(F.sort(we);e=F.shift();)e.__d&&(t=F.length,a=void 0,r=(o=(n=e).__v).__e,_=[],f=[],(d=n.__P)&&((a=M({},o)).__v=o.__v+1,h.vnode&&h.vnode(a),$e(d,a,o,n.__n,d.ownerSVGElement!==void 0,32&o.__u?[r]:null,_,r??W(o),!!(32&o.__u),f),a.__.__k[a.__i]=a,ot(_,a,f),a.__e!=r&&et(a)),F.length>t&&F.sort(we));se.__r=0}function tt(e,t,n,a,o,r,d,_,f,l,m){var s,y,c,g,P,N=a&&a.__k||Ze,v=t.length;for(n.__d=f,Pt(n,t,N),f=n.__d,s=0;s<v;s++)(c=n.__k[s])!=null&&typeof c!="boolean"&&typeof c!="function"&&(y=c.__i===-1?K:N[c.__i]||K,c.__i=s,$e(e,c,y,o,r,d,_,f,l,m),g=c.__e,c.ref&&y.ref!=c.ref&&(y.ref&&Se(y.ref,null,c),m.push(c.ref,c.__c||g,c)),P==null&&g!=null&&(P=g),65536&c.__u||y.__k===c.__k?f=nt(c,f,e):typeof c.type=="function"&&c.__d!==void 0?f=c.__d:g&&(f=g.nextSibling),c.__d=void 0,c.__u&=-196609);n.__d=f,n.__e=P}function Pt(e,t,n){var a,o,r,d,_,f=t.length,l=n.length,m=l,s=0;for(e.__k=[],a=0;a<f;a++)(o=e.__k[a]=(o=t[a])==null||typeof o=="boolean"||typeof o=="function"?null:typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?ne(null,o,null,null,o):Ce(o)?ne(ce,{children:o},null,null,null):o.__b>0?ne(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o)!=null?(o.__=e,o.__b=e.__b+1,_=Tt(o,n,d=a+s,m),o.__i=_,r=null,_!==-1&&(m--,(r=n[_])&&(r.__u|=131072)),r==null||r.__v===null?(_==-1&&s--,typeof o.type!="function"&&(o.__u|=65536)):_!==d&&(_===d+1?s++:_>d?m>f-d?s+=_-d:s--:s=_<d&&_==d-1?_-d:0,_!==a+s&&(o.__u|=65536))):(r=n[a])&&r.key==null&&r.__e&&(r.__e==e.__d&&(e.__d=W(r)),Ne(r,r,!1),n[a]=null,m--);if(m)for(a=0;a<l;a++)(r=n[a])!=null&&!(131072&r.__u)&&(r.__e==e.__d&&(e.__d=W(r)),Ne(r,r))}function nt(e,t,n){var a,o;if(typeof e.type=="function"){for(a=e.__k,o=0;a&&o<a.length;o++)a[o]&&(a[o].__=e,t=nt(a[o],t,n));return t}return e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e),t&&t.nextSibling}function Tt(e,t,n,a){var o=e.key,r=e.type,d=n-1,_=n+1,f=t[n];if(f===null||f&&o==f.key&&r===f.type)return n;if(a>(f!=null&&!(131072&f.__u)?1:0))for(;d>=0||_<t.length;){if(d>=0){if((f=t[d])&&!(131072&f.__u)&&o==f.key&&r===f.type)return d;d--}if(_<t.length){if((f=t[_])&&!(131072&f.__u)&&o==f.key&&r===f.type)return _;_++}}return-1}function Oe(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||$t.test(t)?n:n+"px"}function te(e,t,n,a,o){var r;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof a=="string"&&(e.style.cssText=a=""),a)for(t in a)n&&t in n||Oe(e.style,t,"");if(n)for(t in n)a&&n[t]===a[t]||Oe(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")r=t!==(t=t.replace(/(PointerCapture)$|Capture$/,"$1")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?a?n.u=a.u:(n.u=Date.now(),e.addEventListener(t,r?je:Me,r)):e.removeEventListener(t,r?je:Me,r);else{if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t!=="rowSpan"&&t!=="colSpan"&&t!=="role"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,n))}}function Me(e){var t=this.l[e.type+!1];if(e.t){if(e.t<=t.u)return}else e.t=Date.now();return t(h.event?h.event(e):e)}function je(e){return this.l[e.type+!0](h.event?h.event(e):e)}function $e(e,t,n,a,o,r,d,_,f,l){var m,s,y,c,g,P,N,v,b,x,L,A,j,I,q,E=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(f=!!(32&n.__u),r=[_=t.__e=n.__e]),(m=h.__b)&&m(t);e:if(typeof E=="function")try{if(v=t.props,b=(m=E.contextType)&&a[m.__c],x=m?b?b.props.value:m.__:a,n.__c?N=(s=t.__c=n.__c).__=s.__E:("prototype"in E&&E.prototype.render?t.__c=s=new E(v,x):(t.__c=s=new oe(v,x),s.constructor=E,s.render=xt),b&&b.sub(s),s.props=v,s.state||(s.state={}),s.context=x,s.__n=a,y=s.__d=!0,s.__h=[],s._sb=[]),s.__s==null&&(s.__s=s.state),E.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=M({},s.__s)),M(s.__s,E.getDerivedStateFromProps(v,s.__s))),c=s.props,g=s.state,s.__v=t,y)E.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(E.getDerivedStateFromProps==null&&v!==c&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(v,x),!s.__e&&(s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(v,s.__s,x)===!1||t.__v===n.__v)){for(t.__v!==n.__v&&(s.props=v,s.state=s.__s,s.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(H){H&&(H.__=t)}),L=0;L<s._sb.length;L++)s.__h.push(s._sb[L]);s._sb=[],s.__h.length&&d.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(v,s.__s,x),s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(c,g,P)})}if(s.context=x,s.props=v,s.__P=e,s.__e=!1,A=h.__r,j=0,"prototype"in E&&E.prototype.render){for(s.state=s.__s,s.__d=!1,A&&A(t),m=s.render(s.props,s.state,s.context),I=0;I<s._sb.length;I++)s.__h.push(s._sb[I]);s._sb=[]}else do s.__d=!1,A&&A(t),m=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++j<25);s.state=s.__s,s.getChildContext!=null&&(a=M(M({},a),s.getChildContext())),y||s.getSnapshotBeforeUpdate==null||(P=s.getSnapshotBeforeUpdate(c,g)),tt(e,Ce(q=m!=null&&m.type===ce&&m.key==null?m.props.children:m)?q:[q],t,n,a,o,r,d,_,f,l),s.base=t.__e,t.__u&=-161,s.__h.length&&d.push(s),N&&(s.__E=s.__=null)}catch(H){t.__v=null,f||r!=null?(t.__e=_,t.__u|=f?160:32,r[r.indexOf(_)]=null):(t.__e=n.__e,t.__k=n.__k),h.__e(H,t,n)}else r==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Et(n.__e,t,n,a,o,r,d,f,l);(m=h.diffed)&&m(t)}function ot(e,t,n){t.__d=void 0;for(var a=0;a<n.length;a++)Se(n[a],n[++a],n[++a]);h.__c&&h.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(r){r.call(o)})}catch(r){h.__e(r,o.__v)}})}function Et(e,t,n,a,o,r,d,_,f){var l,m,s,y,c,g,P,N=n.props,v=t.props,b=t.type;if(b==="svg"&&(o=!0),r!=null){for(l=0;l<r.length;l++)if((c=r[l])&&"setAttribute"in c==!!b&&(b?c.localName===b:c.nodeType===3)){e=c,r[l]=null;break}}if(e==null){if(b===null)return document.createTextNode(v);e=o?document.createElementNS("http://www.w3.org/2000/svg",b):document.createElement(b,v.is&&v),r=null,_=!1}if(b===null)N===v||_&&e.data===v||(e.data=v);else{if(r=r&&ie.call(e.childNodes),N=n.props||K,!_&&r!=null)for(N={},l=0;l<e.attributes.length;l++)N[(c=e.attributes[l]).name]=c.value;for(l in N)c=N[l],l=="children"||(l=="dangerouslySetInnerHTML"?s=c:l==="key"||l in v||te(e,l,null,c,o));for(l in v)c=v[l],l=="children"?y=c:l=="dangerouslySetInnerHTML"?m=c:l=="value"?g=c:l=="checked"?P=c:l==="key"||_&&typeof c!="function"||N[l]===c||te(e,l,c,N[l],o);if(m)_||s&&(m.__html===s.__html||m.__html===e.innerHTML)||(e.innerHTML=m.__html),t.__k=[];else if(s&&(e.innerHTML=""),tt(e,Ce(y)?y:[y],t,n,a,o&&b!=="foreignObject",r,d,r?r[0]:n.__k&&W(n,0),_,f),r!=null)for(l=r.length;l--;)r[l]!=null&&Qe(r[l]);_||(l="value",g!==void 0&&(g!==e[l]||b==="progress"&&!g||b==="option"&&g!==N[l])&&te(e,l,g,N[l],!1),l="checked",P!==void 0&&P!==e[l]&&te(e,l,P,N[l],!1))}return e}function Se(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(a){h.__e(a,n)}}function Ne(e,t,n){var a,o;if(h.unmount&&h.unmount(e),(a=e.ref)&&(a.current&&a.current!==e.__e||Se(a,null,t)),(a=e.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(r){h.__e(r,t)}a.base=a.__P=null,e.__c=void 0}if(a=e.__k)for(o=0;o<a.length;o++)a[o]&&Ne(a[o],t,n||typeof e.type!="function");n||e.__e==null||Qe(e.__e),e.__=e.__e=e.__d=void 0}function xt(e,t,n){return this.constructor(e,n)}function Lt(e,t,n){var a,o,r,d;h.__&&h.__(e,t),o=(a=!1)?null:t.__k,r=[],d=[],$e(t,e=t.__k=St(ce,null,[e]),o||K,K,t.ownerSVGElement!==void 0,o?null:t.firstChild?ie.call(t.childNodes):null,r,o?o.__e:t.firstChild,a,d),ot(r,e,d)}ie=Ze.slice,h={__e:function(e,t,n,a){for(var o,r,d;t=t.__;)if((o=t.__c)&&!o.__)try{if((r=o.constructor)&&r.getDerivedStateFromError!=null&&(o.setState(r.getDerivedStateFromError(e)),d=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,a||{}),d=o.__d),d)return o.__E=o}catch(_){e=_}throw e}},Xe=0,oe.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=M({},this.state),typeof e=="function"&&(e=e(M({},n),this.props)),e&&M(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),De(this))},oe.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),De(this))},oe.prototype.render=ce,F=[],Ye=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,we=function(e,t){return e.__v.__b-t.__v.__b},se.__r=0;var At=0;function i(e,t,n,a,o,r){var d,_,f={};for(_ in t)_=="ref"?d=t[_]:f[_]=t[_];var l={type:e,props:f,key:n,ref:d,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--At,__i:-1,__u:0,__source:o,__self:r};if(typeof e=="function"&&(d=e.defaultProps))for(_ in d)f[_]===void 0&&(f[_]=d[_]);return h.vnode&&h.vnode(l),l}var X,S,be,Ue,Y=0,rt=[],re=[],Re=h.__b,Fe=h.__r,Be=h.diffed,Ve=h.__c,We=h.unmount;function Pe(e,t){h.__h&&h.__h(S,e,Y||t),Y=0;var n=S.__H||(S.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:re}),n.__[e]}function $(e){return Y=1,Ht(it,e)}function Ht(e,t,n){var a=Pe(X++,2);if(a.t=e,!a.__c&&(a.__=[it(void 0,t),function(_){var f=a.__N?a.__N[0]:a.__[0],l=a.t(f,_);f!==l&&(a.__N=[l,a.__[1]],a.__c.setState({}))}],a.__c=S,!S.u)){var o=function(_,f,l){if(!a.__c.__H)return!0;var m=a.__c.__H.__.filter(function(y){return y.__c});if(m.every(function(y){return!y.__N}))return!r||r.call(this,_,f,l);var s=!1;return m.forEach(function(y){if(y.__N){var c=y.__[0];y.__=y.__N,y.__N=void 0,c!==y.__[0]&&(s=!0)}}),!(!s&&a.__c.props===_)&&(!r||r.call(this,_,f,l))};S.u=!0;var r=S.shouldComponentUpdate,d=S.componentWillUpdate;S.componentWillUpdate=function(_,f,l){if(this.__e){var m=r;r=void 0,o(_,f,l),r=m}d&&d.call(this,_,f,l)},S.shouldComponentUpdate=o}return a.__N||a.__}function V(e,t){var n=Pe(X++,3);!h.__s&&st(n.__H,t)&&(n.__=e,n.i=t,S.__H.__h.push(n))}function R(e){return Y=5,at(function(){return{current:e}},[])}function at(e,t){var n=Pe(X++,7);return st(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function qe(e,t){return Y=8,at(function(){return e},t)}function It(){for(var e;e=rt.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(ae),e.__H.__h.forEach(ke),e.__H.__h=[]}catch(t){e.__H.__h=[],h.__e(t,e.__v)}}h.__b=function(e){S=null,Re&&Re(e)},h.__r=function(e){Fe&&Fe(e),X=0;var t=(S=e.__c).__H;t&&(be===S?(t.__h=[],S.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=re,n.__N=n.i=void 0})):(t.__h.forEach(ae),t.__h.forEach(ke),t.__h=[],X=0)),be=S},h.diffed=function(e){Be&&Be(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(rt.push(t)!==1&&Ue===h.requestAnimationFrame||((Ue=h.requestAnimationFrame)||Dt)(It)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==re&&(n.__=n.__V),n.i=void 0,n.__V=re})),be=S=null},h.__c=function(e,t){t.some(function(n){try{n.__h.forEach(ae),n.__h=n.__h.filter(function(a){return!a.__||ke(a)})}catch(a){t.some(function(o){o.__h&&(o.__h=[])}),t=[],h.__e(a,n.__v)}}),Ve&&Ve(e,t)},h.unmount=function(e){We&&We(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(a){try{ae(a)}catch(o){t=o}}),n.__H=void 0,t&&h.__e(t,n.__v))};var Je=typeof requestAnimationFrame=="function";function Dt(e){var t,n=function(){clearTimeout(a),Je&&cancelAnimationFrame(t),setTimeout(e)},a=setTimeout(n,100);Je&&(t=requestAnimationFrame(n))}function ae(e){var t=S,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),S=t}function ke(e){var t=S;e.__c=e.__(),S=t}function st(e,t){return!e||e.length!==t.length||t.some(function(n,a){return n!==e[a]})}function it(e,t){return typeof t=="function"?t(e):t}function Ot({user:e,authReady:t,onSignIn:n,onSignOut:a,content:o,onContentChange:r,anonymous:d,onToggleAnonymous:_,onPost:f,showCaptcha:l,turnstileRef:m,status:s,leaderboard:y,leaderboardMe:c,leaderboardStatus:g,leaderboardLoading:P,isMobile:N,mobileView:v,onMobileCta:b,fadeClass:x}){return i("aside",{className:`composer${x?` ${x}`:""}`,children:[i("div",{className:"composer-header",children:[i("h2",{className:"sidebar-header",children:"have an idea?"}),N&&v==="composer"?i("button",{className:"mobile-cta",onClick:b,children:"need an idea? â†’"}):null]}),e?i("div",{className:"auth-row",children:[i("span",{children:["signed in as ",e.handle]}),i("button",{className:"auth-btn",onClick:a,children:"sign out"})]}):t?i("button",{className:"auth-btn",onClick:n,children:"sign in with ð•"}):null,i("div",{children:i("textarea",{id:"idea-input",maxLength:200,placeholder:"something that should exist (max 200 char.)",value:o,rows:3,onInput:L=>r(L.target.value)})}),i("div",{className:"composer-actions",children:[e?i("button",{type:"button",className:`anon-toggle${d?" is-anon":""}`,onClick:_,children:i("span",{className:"anon-track",children:[i("span",{className:"anon-option anon-user",children:e.handle}),i("span",{className:"anon-option anon-anon",children:"anonymous"})]})}):i("div",{className:"anon-label",children:"anonymous"}),i("button",{id:"post-btn",onClick:f,children:"post"})]}),l?i("div",{className:"captcha-wrap",children:i("div",{ref:m})}):null,s?i("div",{id:"status",children:s}):null,i("section",{className:"what-is",children:[i("h2",{className:"sidebar-header",children:"what is this?"}),i("p",{children:"sometimes you come up with a great idea that you don't have the time forâ€”something you want, something ultra-profitable, or just something that would make the world a little better. this is the place for those ideas to find a home."})]}),i("section",{className:"leaderboard",children:[i("h2",{className:"sidebar-header",children:"leaderboard"}),P?i("div",{className:"leaderboard-status",children:"loading..."}):y.length?i("ol",{className:"leaderboard-list",children:y.map((L,A)=>i("li",{className:"leaderboard-item",children:[i("span",{className:"leaderboard-rank",children:[A+1,"."]}),i("div",{className:"leaderboard-main",children:[i("span",{className:"leaderboard-handle",children:L.handle}),i("span",{className:"leaderboard-meta",children:[L.upvote_total," upvotes / ",L.reply_count," replies"]})]}),i("span",{className:"leaderboard-score",children:L.score})]},L.handle||A))}):i("div",{className:"leaderboard-status",children:g||"no ranked users yet."}),c?i("div",{className:"leaderboard-me",children:[i("div",{className:"leaderboard-me-title",children:"your rank"}),i("div",{className:"leaderboard-me-row",children:[i("span",{className:"leaderboard-rank",children:[c.rank,"."]}),i("div",{className:"leaderboard-main",children:[i("span",{className:"leaderboard-handle",children:c.handle}),i("span",{className:"leaderboard-meta",children:[c.upvote_total," upvotes / ",c.reply_count," replies"]})]}),i("span",{className:"leaderboard-score",children:c.score})]})]}):null]})]})}function Mt({topComment:e,topCommentAuthor:t,isOpen:n,loading:a,comments:o,draft:r,onDraftChange:d,onSubmit:_,onToggle:f,onVote:l}){const m=e?o.find(c=>c.content===e&&c.author===t):null,s=m?o.filter(c=>c.id!==m.id):o,y=!a&&s.length===0&&!e;return i("div",{className:`comment-thread${n?" is-open":""}`,children:[e&&!n?i("button",{className:"comment-preview-button",onClick:f,children:["â€œ",e,"â€",i("span",{className:"comment-preview-author",children:["â€”Â ",t]})]}):null,n?i("div",{className:"comment-panel",children:[a?i("div",{className:"comment-muted",children:"loading..."}):null,y?i("div",{className:"comment-muted",children:"no comments yet"}):null,m?i("div",{className:"comment-item",children:[i("div",{className:"comment-body",children:[i("span",{className:"comment-content",children:["â€œ",m.content,"â€"]}),i("span",{className:"comment-author",children:["â€”Â ",m.author]})]}),i("div",{className:"comment-votes",children:[i("button",{className:`comment-vote-btn${m.my_vote===1?" is-active":""}`,onClick:()=>l(m.id,1),children:"â–²"}),i("div",{className:"comment-vote-count",children:m.upvotes??0}),i("button",{className:`comment-vote-btn${m.my_vote===-1?" is-active":""}`,onClick:()=>l(m.id,-1),children:"â–¼"})]})]},m.id):null,s.map(c=>i("div",{className:"comment-item",children:[i("div",{className:"comment-body",children:[i("span",{className:"comment-content",children:["â€œ",c.content,"â€"]}),i("span",{className:"comment-author",children:["â€”Â ",c.author]})]}),i("div",{className:"comment-votes",children:[i("button",{className:`comment-vote-btn${c.my_vote===1?" is-active":""}`,onClick:()=>l(c.id,1),children:"â–²"}),i("div",{className:"comment-vote-count",children:c.upvotes??0}),i("button",{className:`comment-vote-btn${c.my_vote===-1?" is-active":""}`,onClick:()=>l(c.id,-1),children:"â–¼"})]})]},c.id)),i("div",{className:"comment-form",children:[i("textarea",{className:"comment-input",maxLength:200,rows:1,placeholder:"leave a comment (max 200)",value:r,onInput:c=>{const g=c.currentTarget;g.style.height="auto",g.style.height=`${g.scrollHeight}px`,d(g.value)}}),i("button",{className:"comment-submit",onClick:_,children:"comment"})]})]}):null]})}function jt({idea:e,onVote:t,isOpen:n,onToggleComments:a,comments:o,loadingComments:r,commentDraft:d,onDraftChange:_,onPostComment:f,onVoteComment:l}){const m=e.comment_count||0,s=n?"hide comments":m===0?"leave a comment...":`show ${m} comment${m===1?"":"s"}`,y=!!e.top_comment||n;return i("div",{className:"idea",children:[i("div",{className:"idea-row",children:[i("div",{className:"idea-content",children:i("p",{className:"idea-text",children:e.content})}),i("div",{className:"votes",children:[i("button",{className:`vote-btn${e.my_vote===1?" is-active":""}`,onClick:()=>t(e,1),children:"â–²"}),i("div",{className:"vote-count",children:e.upvotes>0?"+"+e.upvotes:0}),i("button",{className:`vote-btn${e.my_vote===-1?" is-active":""}`,onClick:()=>t(e,-1),children:"â–¼"})]})]}),i("div",{className:"idea-meta-row",children:[i("div",{className:"idea-meta",children:e.author}),i("button",{className:"comment-toggle",onClick:a,children:s})]}),y?i(Mt,{topComment:e.top_comment,topCommentAuthor:e.top_comment_author,isOpen:n,loading:r,comments:o,draft:d,onDraftChange:_,onSubmit:f,onToggle:a,onVote:l}):null]})}function Ut({ideas:e,loading:t,hasMore:n,sentinelRef:a,isMobile:o,mobileView:r,onMobileCta:d,fadeClass:_,onVote:f,commentOpen:l,toggleComments:m,commentLoading:s,commentsByIdea:y,commentDrafts:c,onDraftChange:g,onPostComment:P,onVoteComment:N}){return i("section",{className:`feed${_?` ${_}`:""}`,children:[i("div",{className:"feed-header",children:[i("h1",{children:"need an idea?"}),o&&r==="feed"?i("button",{className:"mobile-cta",onClick:d,children:"have an idea? â†’"}):null]}),i("section",{id:"ideas",children:e.map(v=>i(jt,{idea:v,onVote:f,isOpen:!!l[v.id],onToggleComments:()=>m(v.id),comments:y[v.id]||[],loadingComments:!!s[v.id],commentDraft:c[v.id]||"",onDraftChange:b=>g(v.id,b),onPostComment:()=>P(v.id),onVoteComment:(b,x)=>N(v.id,b,x)},v.id))}),i("div",{className:"sentinel",ref:a,children:t?i("div",{className:"loading-dots",role:"status","aria-label":"loading",children:[i("span",{className:"loading-dot"}),i("span",{className:"loading-dot"}),i("span",{className:"loading-dot"})]}):n?"":"no more ideas :("})]})}const O="/api",Rt="",ze=15,ct="pinned_ideas";function Ge(){try{return localStorage.getItem("session_token")||""}catch{return""}}function Ft(e){try{localStorage.setItem("session_token",e)}catch{return}}function Ke(){try{localStorage.removeItem("session_token")}catch{return}}function Bt(){if(typeof window>"u")return[];try{const e=sessionStorage.getItem(ct)||"[]",t=JSON.parse(e);return Array.isArray(t)?t.map(n=>Number(n)).filter(n=>Number.isFinite(n)):[]}catch{return[]}}function Vt(e){if(!(typeof window>"u"))try{sessionStorage.setItem(ct,JSON.stringify(e))}catch{return}}function Wt(e,t){if(!t.length)return e;const n=new Map;e.forEach(o=>{n.has(o.id)||n.set(o.id,o)});const a=[];return t.forEach(o=>{const r=n.get(o);r&&(a.push(r),n.delete(o))}),[...a,...n.values()]}function qt(){const[e,t]=$([]),[n,a]=$(""),[o,r]=$(""),[d,_]=$([]),[f,l]=$(null),[m,s]=$(""),[y,c]=$(!1),[g,P]=$(!1),[N,v]=$(!0),[b,x]=$(!1),[L,A]=$(!0),[j,I]=$(null),[q,E]=$(!1),[H,lt]=$(!1),[J,Te]=$("feed"),[le,Z]=$(""),[Ee,_t]=$({}),[xe,_e]=$({}),[Le,Ae]=$({}),[ut,ue]=$({}),[de,dt]=$(()=>Bt()),fe=R(null),B=R(null),me=R(null),Q=R(!1),he=R(!1),ee=R([]),pe=R(de);V(()=>{pe.current=de},[de]);function U(){const u=Ge();return u?{authorization:`Bearer ${u}`}:{}}async function ft(){const u=Ge();if(!u){I(null),E(!0);return}E(!1);const p=await fetch(`${O}/me`,{headers:{authorization:`Bearer ${u}`}});if(!p.ok){Ke(),I(null),E(!0);return}const k=await p.json();I(k.user||null),E(!0)}function mt(){if(window.turnstile&&B.current!==null)return window.turnstile.getResponse(B.current)||"";const u=document.querySelector('input[name="cf-turnstile-response"]');return u?u.value:""}function ve(){ee.current.forEach(u=>clearTimeout(u)),ee.current=[]}function ye(u){if(!H||J===u||le)return;ve(),Z("is-fading-out");const p=setTimeout(()=>{Te(u),Z("is-fading-in");const k=setTimeout(()=>{Z("")},250);ee.current.push(k)},250);ee.current.push(p)}const z=qe(async(u,p=!1)=>{if(Q.current)return;Q.current=!0;const k=typeof performance<"u"?performance.now():Date.now();P(!0);const w=await fetch(`${O}/ideas?limit=${ze}&offset=${u}`,{headers:U()});if(!w.ok){r("failed to load ideas"),P(!1),Q.current=!1;return}const C=(await w.json()).ideas||[],He=400-((typeof performance<"u"?performance.now():Date.now())-k);He>0&&await new Promise(ge=>setTimeout(ge,He)),t(ge=>{const Ct=p?C:[...ge,...C];return Wt(Ct,pe.current)}),v(C.length===ze),P(!1),Q.current=!1},[]),G=qe(async()=>{if(!he.current){he.current=!0,c(!0),s("");try{const u=await fetch(`${O}/leaderboard?limit=10`,{headers:U()});if(!u.ok){s("failed to load leaderboard");return}const p=await u.json();_(p.leaderboard||[]),l(p.me||null)}catch{s("failed to load leaderboard")}finally{c(!1),he.current=!1}}},[]);async function ht(u,p){if((u.my_vote||0)===p)return;const w=await fetch(`${O}/ideas/${u.id}/vote`,{method:"POST",headers:{"content-type":"application/json",...U()},body:JSON.stringify({delta:p})});if(!w.ok){const C=await w.json().catch(()=>({}));r(C.error||"vote failed");return}const T=await w.json();t(C=>C.map(D=>D.id===T.id?T:D)),G()}async function pt(u){ue(w=>({...w,[u]:!0}));const p=await fetch(`${O}/ideas/${u}/comments`,{headers:U()});if(!p.ok){r("failed to load comments"),ue(w=>({...w,[u]:!1}));return}const k=await p.json();_e(w=>({...w,[u]:k.comments||[]})),ue(w=>({...w,[u]:!1}))}function vt(u){const p=!!Ee[u];_t(k=>({...k,[u]:!p})),!p&&!xe[u]&&pt(u)}function yt(u,p){Ae(k=>({...k,[u]:p}))}async function gt(u){const p=(Le[u]||"").trim();if(!p){r("please add a comment");return}if(p.length>200){r("comment must be 1-200 characters");return}const k=await fetch(`${O}/ideas/${u}/comments`,{method:"POST",headers:{"content-type":"application/json",...U()},body:JSON.stringify({content:p})});if(!k.ok){const T=await k.json().catch(()=>({}));r(T.error||"failed to post comment");return}const w=await k.json();_e(T=>({...T,[u]:[w,...T[u]||[]]})),Ae(T=>({...T,[u]:""})),t(T=>T.map(C=>C.id===u?{...C,comment_count:(C.comment_count||0)+1,top_comment:w.content,top_comment_author:w.author}:C)),G()}async function bt(u,p,k){const w=await fetch(`${O}/comments/${p}/vote`,{method:"POST",headers:{"content-type":"application/json",...U()},body:JSON.stringify({delta:k})});if(!w.ok){const C=await w.json().catch(()=>({}));r(C.error||"comment vote failed");return}const T=await w.json();_e(C=>({...C,[u]:(C[u]||[]).map(D=>D.id===T.id?T:D)}))}async function wt(){const u=n.trim(),p=mt();if(!j&&!L){r("sign in with X to post");return}if(!u){r("please add an idea");return}if(!b){x(!0),r("please complete the captcha");return}if(!p){r("please complete the captcha");return}r("posting...");const k=await fetch(`${O}/ideas`,{method:"POST",headers:{"content-type":"application/json",...U()},body:JSON.stringify({content:u,anonymous:L,token:p})});if(!k.ok){const T=await k.json().catch(()=>({}));r(T.error||"failed to post");return}const w=await k.json();dt(T=>{const C=[w.id,...T.filter(D=>D!==w.id)];return Vt(C),pe.current=C,C}),a(""),window.turnstile&&B.current!==null&&window.turnstile.reset(B.current),r("posted"),t([]),v(!0),x(!1),z(0,!0),G(),H&&ye("feed")}function Nt(){const u=window.location.pathname;window.location.href=`${Rt}/auth/x/start?returnTo=${encodeURIComponent(u)}`}function kt(){Ke(),I(null),A(!0),E(!0),l(null)}return V(()=>{const u=new URLSearchParams(window.location.search),p=u.get("token");if(p){Ft(p),u.delete("token");const k=u.toString(),w=k?`${window.location.pathname}?${k}`:window.location.pathname;window.history.replaceState({},"",w)}ft(),z(0,!0),G()},[z,G]),V(()=>{A(!j)},[j]),V(()=>{if(typeof window>"u")return;const u=window.matchMedia("(max-width: 900px)"),p=()=>{lt(u.matches),u.matches||(ve(),Z(""),Te("feed"))};return p(),u.addEventListener?u.addEventListener("change",p):u.addListener(p),()=>{ve(),u.removeEventListener?u.removeEventListener("change",p):u.removeListener(p)}},[]),V(()=>{let u=!1;function p(){if(!u&&b){if(!window.turnstile||!fe.current){setTimeout(p,100);return}B.current===null&&(B.current=window.turnstile.render(fe.current,{sitekey:"0x4AAAAAACWiWyPsPuepbbp9"}))}}return p(),()=>{u=!0}},[b]),V(()=>{if(!me.current)return;const u=new IntersectionObserver(p=>{p[0].isIntersecting&&(!N||g||z(e.length,!1))},{rootMargin:"200px"});return u.observe(me.current),()=>u.disconnect()},[e.length,N,g,z]),i("main",{children:i("div",{className:`layout${H?" is-mobile":""}`,children:[!H||J==="feed"?i(Ut,{ideas:e,loading:g,hasMore:N,sentinelRef:me,isMobile:H,mobileView:J,onMobileCta:()=>ye("composer"),fadeClass:le,onVote:ht,commentOpen:Ee,toggleComments:vt,commentLoading:ut,commentsByIdea:xe,commentDrafts:Le,onDraftChange:yt,onPostComment:gt,onVoteComment:bt}):null,!H||J==="composer"?i(Ot,{user:j,authReady:q,onSignIn:Nt,onSignOut:kt,content:n,onContentChange:a,anonymous:L,onToggleAnonymous:()=>A(u=>!u),onPost:wt,showCaptcha:b,turnstileRef:fe,status:o,leaderboard:d,leaderboardMe:f,leaderboardStatus:m,leaderboardLoading:y,isMobile:H,mobileView:J,onMobileCta:()=>ye("feed"),fadeClass:le}):null]})})}Lt(i(qt,{}),document.getElementById("app"));
